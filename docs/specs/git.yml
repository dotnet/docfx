---
# Show git contribution info when userProfile & commitsTime is set to URL
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-url
outputs:
  readme.json: |
    {
      "author": {
        "name": "superyyrrzz",
        "profile_url": "https://github.com/superyyrrzz",
        "display_name": "Renze Yu",
        "id": "3831744"
      },
      "contributors": [
        {
          "name": "yufeih",
          "profile_url": "https://github.com/yufeih",
          "display_name": "Yufei Huang",
          "id": "511355"
        },
        {
          "name": "OsmondJiang",
          "profile_url": "https://github.com/OsmondJiang",
          "display_name": "Osmond Jiang",
          "id": "19990166"
        }
      ],
      "updated_at": "1874-01-01T00:00:00.0000000"
    }
---
# Show git contribution info when userProfile & commitsTime is set to relative file path
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
inputs:
  docfx.yml: |
    content: README.md
    gitHub:
      userCache: user_profile.json
      resolveUsers: true
    contribution:
      gitCommitsTime: build_history.json
outputs:
  readme.json: |
    {
      "author": {
        "name": "superyyrrzz",
        "profile_url": "https://github.com/superyyrrzz",
        "display_name": "Renze Yu",
        "id": "3831744"
      },
      "contributors": [
        {
          "name": "yufeih",
          "profile_url": "https://github.com/yufeih",
          "display_name": "Yufei Huang",
          "id": "511355"
        },
        {
          "name": "OsmondJiang",
          "profile_url": "https://github.com/OsmondJiang",
          "display_name": "Osmond Jiang",
          "id": "19990166"
        }
      ],
      "updated_at": "1874-01-01T00:00:00.0000000"
    }
---
# Specify invalid author in YAML header should log warning
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
inputs:
  README.md: |
    ---
    author: invalid_user
    ---
    # git-test
  user_profile.json: |
    {
      "users": [
        {"login": "invalid_user"},
        {"name": "Osmond Jiang", "login": "OsmondJiang", "id": 19990166, "emails": ["xinjiang@microsoft.com"]},
        {"name": "Renze Yu", "login": "superyyrrzz", "id": 3831744, "emails": ["renzeyu@microsoft.com","superyyrrzz@gmail.com"]},
        {"name": "Yufei Huang", "login": "yufeih", "id": 511355, "emails": ["yufeih@users.noreply.github.com","yufeih@live.com"]}
      ]
    }
outputs:
  readme.json:
  build.log: |
    ["warning","github-user-not-found","Cannot find user 'invalid_user' on GitHub","README.md"]
---
# Author should NOT exist in contributors. Author can have no contribution to the file before.
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
inputs:
  README.md: |
    ---
    author: real_author
    ---
    # git-test
  user_profile.json: |
    {
      "users": [
        {"name": "Real Author", "login": "real_author", "id": 31415926, "emails": ["real_author@contoso.com"]},
        {"name": "Osmond Jiang", "login": "OsmondJiang", "id": 19990166, "emails": ["xinjiang@microsoft.com"]},
        {"name": "Renze Yu", "login": "superyyrrzz", "id": 3831744, "emails": ["renzeyu@microsoft.com","superyyrrzz@gmail.com"]},
        {"name": "Yufei Huang", "login": "yufeih", "id": 511355, "emails": ["yufeih@users.noreply.github.com","yufeih@live.com"]}
      ]
    }
outputs:
  readme.json: |
    {
      "author": {
        "name": "real_author",
        "profile_url": "https://github.com/real_author",
        "display_name": "Real Author",
        "id": "31415926"
      },
      "contributors": [
        {
          "name": "yufeih",
          "profile_url": "https://github.com/yufeih",
          "display_name": "Yufei Huang",
          "id": "511355"
        },
        {
          "name": "superyyrrzz",
          "profile_url": "https://github.com/superyyrrzz",
          "display_name": "Renze Yu",
          "id": "3831744"
        },
        {
          "name": "OsmondJiang",
          "profile_url": "https://github.com/OsmondJiang",
          "display_name": "Osmond Jiang",
          "id": "19990166"
        }
      ],
    }
---
# Author is case-insensitive
# Contributors can be excluded, it's case insensitive
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
inputs:
  README.md: |
    ---
    author: OSMONDJIANG
    ---
  docfx.yml: |
    files: "README.md"
    github:
      resolveUsers: true
      userCache: user_profile.json
    contribution:
      excludedContributors:
        - superyyrrZZ
        - YUFEIH
outputs:
  readme.json: |
    {
      "author":  {
        "name": "OsmondJiang",
        "profile_url": "https://github.com/OsmondJiang",
        "display_name": "Osmond Jiang",
        "id": "19990166"
      },
      "contributors": [
      ],
    }
---
# Use the earliest contributor as author if author not specified in YAML header
repo: https://github.com/docascode/docfx-test-dependencies#contributors
outputs:
  contributors.json: |
    {
      "author": {
        "name": "superyyrrzz",
        "profile_url": "https://github.com/superyyrrzz",
        "display_name": "Renze Yu",
        "id": "3831744"
      }
    }
---
# Author can be excluded, it's case insensitive
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
inputs:
  docfx.yml: |
    files: "README.md"
    github:
      userCache: user_profile.json
      resolveUsers: true
    contribution:
      excludedContributors:
        - superyyrrZZ
outputs:
  readme.json: |
    {
      "!author": null,
      "contributors": [
        {
          "name": "yufeih",
          "profile_url": "https://github.com/yufeih",
          "display_name": "Yufei Huang",
          "id": "511355"
        },
        {
          "name": "OsmondJiang",
          "profile_url": "https://github.com/OsmondJiang",
          "display_name": "Osmond Jiang",
          "id": "19990166"
        }
      ],
    }
---
# Show content_git_url, original_content_git_url and gitcommit
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
outputs:
  readme.json: |
    {
      "open_to_public_contributors": true,
      "content_git_url": "https://github.com/docascode/docfx-test-dependencies/blob/github-user-cache-file/README.md",
      "original_content_git_url": "https://github.com/docascode/docfx-test-dependencies/blob/github-user-cache-file/README.md",
      "gitcommit": "https://github.com/docascode/docfx-test-dependencies/blob/b1f007c5a4a65274e64c0d4cfd128183c1a7e600/README.md",
    }
---
# Specify editLink repo and branch in config
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
inputs:
  docfx.yml: |
    files: "README.md"
    github:
      userCache: user_profile.json
      resolveUsers: true
    contribution:
      repository: https://github.com/test-org/test-repo#contribution
outputs:
  readme.json: |
    {
      "content_git_url": "https://github.com/test-org/test-repo/blob/contribution/README.md",
      "original_content_git_url": "https://github.com/docascode/docfx-test-dependencies/blob/github-user-cache-file/README.md",
      "gitcommit": "https://github.com/docascode/docfx-test-dependencies/blob/b1f007c5a4a65274e64c0d4cfd128183c1a7e600/README.md",
    }
---
# Don't load git commits when showContributors is set to false
repo: https://github.com/docascode/docfx-test-dependencies#no-load-commits
outputs:
  readme.json: |
    {
      "contributors": [],
      "gitcommit": "https://github.com/docascode/docfx-test-dependencies/blob/5087ddfc6ee4886bcabe8cc93673edd8605fe15c/README.md"
    }
---
# Use commit's time when gitCommitsTime file not given
repo: https://github.com/docascode/docfx-test-dependencies#github-user-cache-file
inputs:
  docfx.yml: |
    files: "README.md"
    github:
      userCache: user_profile.json
      resolveUsers: true
    contribution:
outputs:
  readme.json: |
    {
      "updated_at": "2018-07-27T02:15:49Z",
    }
---
# Support git submodule
repo: https://github.com/docascode/docfx-test-dependencies#docset-with-submodule
outputs:
  readme.json: |
    {
      "gitcommit": "https://github.com/docascode/docfx-test-dependencies/blob/c467c848311ccd2550fdb25a77ef26f9d8a33d00/README.md",
      "updated_at": "2018-04-23T03:23:37Z"
    }
  docfx-test-submodule/readme.json: |
    {
      "gitcommit": "https://github.com/docascode/docfx-test-submodule/blob/b6601c200859547c7fcd44a44788f77a08576505/README.md",
      "updated_at": "2018-07-18T05:03:26Z"
    }
---
