# generate normal document id and version id
# backward compatible to docs.com
# document id = md5("Win.sccm|mdt/release-notes.md")
# version independent id = md5("Win.sccm|mdt/release-notes")
inputs:
  docfx.yml: |
    documentId:
      sourceBasePath: sccm
      siteBasePath: sccm
    name: sccm
    product: Win
    content: sccm/**/*
  sccm/mdt/release-notes.md:
outputs:
  sccm/mdt/release-notes.json: |
    { "content": "", "id": "0b1c8a5d-b639-d555-0850-b98a9010023c", "versionIndependentId": "b20fdb1c-8d40-c3b2-2265-779a3f2dfe98" }
  build.manifest:
---
# generate index document id and version id
# backward compatible to docs.com
# document id = md5("Win.sccm|index.md") || md5("Win.sccm|mdm/index.md")
# version independent id = md5("Win.sccm|index") || md5("Win.sccm|mdm/index")
inputs:
  docfx.yml: |
    documentId:
      sourceBasePath: sccm
      siteBasePath: sccm
    name: sccm
    product: Win
    content: "**/*"
  sccm/mdm/index.md:
  sccm/index.md:
outputs:
  sccm/index.json: |
    { "content": "", "id": "29602e3e-439e-865c-f1c9-2eb706f97b31", "versionIndependentId": "34196fc5-28d6-b496-a21f-8661876802c7" }
  sccm/mdm/index.json: |
    { "content": "", "id": "1c42a151-6248-df0c-15e6-3b1158d7bee3", "versionIndependentId": "beb14a44-b076-14b8-b9c5-b42f9e36b973" }
  build.manifest:
---
# generate same document id and version id with 'redirection with document id'
# A => B, B's ids should be same with A's
inputs:
  docfx.yml: |
    documentId:
      sourceBasePath: sccm
      siteBasePath: sccm
    name: sccm
    product: Win
    content: "**/*"
    redirections:
      sccm/mdm/index.md: /sccm/mdm/understand/hybrid-mobile-device-management
  sccm/mdm/understand/hybrid-mobile-device-management.md:
outputs:
  sccm/mdm/understand/hybrid-mobile-device-management.json: |
    { "id": "1c42a151-6248-df0c-15e6-3b1158d7bee3", "versionIndependentId": "beb14a44-b076-14b8-b9c5-b42f9e36b973" }
  sccm/mdm/index.json: |
    { "redirectionUrl":"/sccm/mdm/understand/hybrid-mobile-device-management" }
  build.manifest:
---
# generate different document id and version id with 'redirection without document id'
inputs:
  docfx.yml: |
    documentId:
      sourceBasePath: sccm
      siteBasePath: sccm
    name: sccm
    product: Win
    content: "**/*"
    redirectionsWithoutId:
      sccm/mdm/index.md: /sccm/mdm/understand/hybrid-mobile-device-management
  sccm/mdm/understand/hybrid-mobile-device-management.md:
outputs:
  sccm/mdm/understand/hybrid-mobile-device-management.json: |
    { "id": "7412621b-4920-dc7e-bed6-1f1ea774f7dd", "versionIndependentId": "de5d1641-2c0e-1158-7611-e52a22d96a5e" }
  sccm/mdm/index.json: |
    { "redirectionUrl":"/sccm/mdm/understand/hybrid-mobile-device-management" }
  build.manifest:
---
# get conflicted redirection document id warning if two or more files redirect to the same file with document id
inputs:
  docfx.yml: |
    documentId:
      sourceBasePath: sccm
      siteBasePath: sccm
    name: sccm
    product: Win
    content: "**/*"
    redirections:
      sccm/mdm/index.md: /sccm/mdm/understand/hybrid-mobile-device-management
      sccm/mdm/index2.md: /sccm/mdm/understand/hybrid-mobile-device-management
  sccm/mdm/understand/hybrid-mobile-device-management.md:
outputs:
  sccm/mdm/understand/hybrid-mobile-device-management.json: |
    { "id": "1c42a151-6248-df0c-15e6-3b1158d7bee3", "versionIndependentId": "beb14a44-b076-14b8-b9c5-b42f9e36b973" }
  sccm/mdm/index.json: |
    { "redirectionUrl":"/sccm/mdm/understand/hybrid-mobile-device-management"}
  sccm/mdm/index2.json: |
    { "redirectionUrl":"/sccm/mdm/understand/hybrid-mobile-device-management" }
  build.manifest:
  build.log: |
    ["warning","redirected-id-conflict","Multiple documents redirected to '/sccm/mdm/understand/hybrid-mobile-device-management' with document id: 'sccm/mdm/index.md', 'sccm/mdm/index2.md'","docfx.yml"]
---
# generate document id with depot mapping and directory mapping
# id = hash({mapped_depot_name}|{mapped_file_in_docset})
# version_independent_id = hash({mapped_depot_name}|{file_path})
inputs:
  docfx.yml: |
    documentId:
      siteBasePath: azure
      depotMappings:
        articles/iot-central/: MSDN.microsoft-iot-central
      directoryMappings:
        articles\iot-central/: articles
        articles\billing/billing-add-change-azure-subscription-administrator.md: articles
    name: azure-documents
    product: Azure
    content: "**/*"
    routes:
      articles/: "azure/"
  articles/iot-central/concepts-architecture.md:
  articles/billing/billing-add-change-azure-subscription-administrator.md:
outputs:
  azure/iot-central/concepts-architecture.json: |
    {"id":"7e13132e-7847-dc4f-90d5-32a233d1c81a","versionIndependentId":"d9cc5ab8-926a-8a5a-312c-10ca36619bad"}
  azure/billing/billing-add-change-azure-subscription-administrator.json: |
    {"id":"f5624f3e-5fbf-6f0f-93cf-a4d5aa93ccf8","versionIndependentId":"9ca6d22b-e684-4e65-cab3-c272189a3ddc"}
  build.manifest:
---
# yaml&json toc metadata
inputs:
  docfx.yml:
  docs/json/TOC.json: |
    {
      "metadata": {"a":"b"},
      "items": [{ "name": "title" }]
    }
  docs/yaml/TOC.yml: |
    metadata:
      a: b
    items:
      - name: title
outputs:
  docs/json/TOC.json: |
    {  
      "metadata": {"a": "b"},
      "items":[{"toc_title":"title"}]
    }
  docs/yaml/TOC.json: |
    {  
      "metadata": {"a": "b"},
      "items":[{"toc_title":"title"}]
    }
  build.manifest:
---
# yaml&json toc leaf metadata
inputs:
  docfx.yml:
  docs/json/TOC.json: |
    [{ "name": "title", "a": "b" }]
  docs/yaml/TOC.yml: |
    - name: title
      a: b
outputs:
  docs/json/TOC.json: |
    {  
      "items":[{"toc_title":"title", "a": "b"}]
    }
  docs/yaml/TOC.json: |
    {  
      "items":[{"toc_title":"title", "a": "b"}]
    }
  build.manifest:
---
# yaml&json toc metadata inclusion
# child's root metadata will be dropped
inputs:
  docfx.yml:
  docs/json/TOC.json: |
    {  
      "metadata": {"a": "b"},
      "items":[{"name":"title", "c": "d"}]
    }
  docs/yaml/TOC.yml: |
    - name: toc reference
      tocHref: ../json/TOC.json
outputs:
  docs/yaml/TOC.json: |
    {  
      "items":[{"toc_title":"toc reference", "children": [{"toc_title":"title", "c": "d"}]}]
    }
  build.manifest:
---
# toc global metadata
inputs:
  docfx.yml: |
    globalMetadata:
      a: b
  docs/json/TOC.json: |
    [{"name":"title"}]
  docs/yaml/TOC.yml: |
    metadata:
      c: d
    items:
      - name: title
  docs/md/TOC.md: |
    # title
outputs:
  docs/yaml/TOC.json: |
    {  
      "items":[{"toc_title":"title"}], "metadata": {"a":"b", "c": "d"}
    }
  docs/json/TOC.json: |
    {  
      "items":[{"toc_title":"title"}], "metadata": {"a":"b"}
    }
  docs/md/TOC.json: |
    {  
      "items":[{"toc_title":"title"}], "metadata": {"a":"b"}
    }
  build.manifest:
---
# redirect to redirect
inputs:
  docfx.yml: |
    documentId:
      siteBasePath: azure
    name: azure-documents
    product: Azure
    content: "**/*"
    routes:
      articles/: "azure/"
    redirections:
      articles/active-directory/active-directory-saas-splunkenterpriseandsplunkcloud-tutorial.md: /azure/active-directory/saas-apps/splunkenterpriseandsplunkcloud-tutorial
      articles/active-directory/active-directory-saas-splunk-enterprise-and-splunk-cloud-tutorial.md: /azure/active-directory/active-directory-saas-splunkenterpriseandsplunkcloud-tutorial
  articles/active-directory/saas-apps/splunkenterpriseandsplunkcloud-tutorial.md:
outputs:
  azure/active-directory/saas-apps/splunkenterpriseandsplunkcloud-tutorial.json: |
    {"id":"b1cdf77e-673b-8b3a-3232-78f3d2b225dd","versionIndependentId":"bde2976d-40d3-f729-128d-0caa664da662"}
  azure/active-directory/active-directory-saas-splunkenterpriseandsplunkcloud-tutorial.json:
  azure/active-directory/active-directory-saas-splunk-enterprise-and-splunk-cloud-tutorial.json:
  build.manifest:
