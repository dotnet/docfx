---
# Links to files are resolved to relative url
inputs:
  docfx.yml:
  docs/a.md: Link to [b](b.md)
  docs/b.md: Link to [a](./a.md)
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"b\">b</a></p>" }
  docs/b.json: |
    { "content": "<p>Link to <a href=\"a\">a</a></p>" }
---
# Preserve query and fragment for links to files
inputs:
  docfx.yml:
  docs/a.md: Link to [b](b.md#a?b=c)
  docs/b.md: Link to [a](./a.md?a=b&c=d#e)
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"b#a?b=c\">b</a></p>" }
  docs/b.json: |
    { "content": "<p>Link to <a href=\"a?a=b&amp;c=d#e\">a</a></p>" }
  build.log: |
    ["warning","external-bookmark-not-found","Cannot find bookmark '#e' in 'docs/a.md'","docs/b.md",1,9]
    ["warning","external-bookmark-not-found","Cannot find bookmark '#a?b=c' in 'docs/b.md'","docs/a.md",1,9]
---
# Links to URLs are preserved as is
inputs:
  docfx.yml:
  docs/a.md: Link to [docs](https://docs.microsoft.com)
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"https://docs.microsoft.com\">docs</a></p>" }
---
# Links to bookmarks in the same article
inputs:
  docfx.yml:
  docs/a.md: |
    ## Hello World
    Link to [bookmark](#hello-world)
  docs/b.md: |
    Link to [self](./b.md)
outputs:
  docs/a.json: |
    { 
      "rawTitle": "<h2 id=\"hello-world\">Hello World</h2>",
      "content": "<p>Link to <a href=\"#hello-world\">bookmark</a></p>" 
    }
  docs/b.json: |
    { "content": "<p>Link to <a href=\"#\">self</a></p>" }
---
# Links to self bookmarks in the included file
inputs:
  docfx.yml: |
    files: docs/a.md
  docs/a.md: |
    # heading
    [!INCLUDE[](includes/b.md)]
    Link to [invalid self](./a.md#heading3)
  docs/includes/b.md: |
    ## test
    Link to [valid self](#test)
    Link to [valid parent](../a.md/#heading)
    Link to [invalid self](#heading1)
    Link to [invalid parent](../a.md/#heading2)
outputs:
  docs/a.json: |
    { "content": "<h2 id=\"test\">test</h2>\n<p>Link to <a href=\"#test\">valid self</a>\nLink to <a href=\"a#heading\">valid parent</a>\nLink to <a href=\"#heading1\">invalid self</a>\nLink to <a href=\"a#heading2\">invalid parent</a></p>\n\n<p>Link to <a href=\"#heading3\">invalid self</a></p>" }
  build.log: |
    ["suggestion","internal-bookmark-not-found","Cannot find bookmark '#heading3' in 'docs/a.md', did you mean '#heading'?","docs/a.md",3,9]
    ["suggestion","internal-bookmark-not-found","Cannot find bookmark '#heading2' in 'docs/includes/b.md', did you mean '#heading'?","docs/includes/b.md",5,9]
    ["suggestion","internal-bookmark-not-found","Cannot find bookmark '#heading1' in 'docs/includes/b.md', did you mean '#heading'?","docs/includes/b.md",4,9]
---
# Support both / and \ as directory seperator
inputs:
  docfx.yml:
  docs/dir-a/a.md: Link to [b](..\dir-b/b.md)
  docs/dir-b/b.md: Link to [a](../dir-a\a.md)
outputs:
  docs/dir-a/a.json: |
    { "content": "<p>Link to <a href=\"../dir-b/b\">b</a></p>" }
  docs/dir-b/b.json: |
    { "content": "<p>Link to <a href=\"../dir-a/a\">a</a></p>" }
---
# Links in include files are resolved relative to the include file
inputs:
  docfx.yml:
  docs/a.md: Link to [!INCLUDE[](dir/b.md)]
  docs/dir/b.md: '[c](c.md)'
  docs/dir/c.md:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"dir/c\">c</a></p>" }
  docs/dir/b.json: |
    { "content": "<p><a href=\"c\">c</a></p>" }
  docs/dir/c.json:
---
# Resolve <a> and <img> tags embeded inside markdown
inputs:
  docfx.yml:
  docs/a.md: Link to <a href="b.md" target="_blank"><em>b</em></a>
  docs/b.md: <div>Link to <img src="c.png" /></div>
  docs/c.png:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"b\" target=\"_blank\"><em>b</em></a></p>" }
  docs/b.json: |
    { "content": "<div>Link to <img src=\"c.png\" /></div>" }
  docs/c.png:
---
# Html links in include files are resolved relative to the include file
inputs:
  docfx.yml:
  docs/a.md: Link to [!INCLUDE[](dir/b.md)]
  docs/dir/b.md: '<a target="_blank" href="c.md">c</a>'
  docs/dir/c.md:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a target=\"_blank\" href=\"dir/c\">c</a></p>" }
  docs/dir/b.json: |
    { "content": "<p><a target=\"_blank\" href=\"c\">c</a></p>" }
  docs/dir/c.json:
---
# Show warning if the link is empty, missing
inputs:
  docfx.yml: |
    exclude: '*'
  docs/a.md: |
    [Empty]() [Invalid](a<>b.md) [!INCLUDE[](../b.md)]
  b.md: |
    [Missing](c.md)
outputs:
  docs/a.json: |
    { "content": "<p><a href=\"\">Empty</a><a href=\"a%3C%3Eb.md\">Invalid</a><a href=\"c.md\">Missing</a></p>" }
  build.log: |
    ["info","link-is-empty","Link is empty","docs/a.md",1,1]
    ["warning","file-not-found","Cannot find file 'a<>b.md' relative to 'docs/a.md'","docs/a.md",1,11]
    ["warning","file-not-found","Cannot find file 'c.md' relative to 'b.md'","b.md",1,1]
---
# Show warning if the link points to absolute file path
inputs:
  docfx.yml:
  docs/a.md: |
    [Absolute](C:/a.md)
outputs:
  docs/a.json: |
    { "content": "<p><a href=\"\">Absolute</a></p>" }
  build.log: |
    ["warning","local-file-path","Link 'C:/a.md' points to a local file. Use a relative path instead.","docs/a.md",1,1]
---
# Show warning if two files share the same site url
inputs:
  docfx.yml:
  docs/a.png.md: '![](a.png)'
  docs/a.png:
outputs:
  build.log: |
    ["error","publish-url-conflict","Two or more files publish to the same url '/docs/a.png': 'docs/a.png', 'docs/a.png.md'"]
---
# Prefer relative url to file when there is a matching folder name
inputs:
  docfx.yml:
  docs/a/index.md: Link to [1](../a.md) [2](a.md)
  docs/a/a.md: Link to [index](index.md)
  docs/a.md: Link to [index](a/index.md)
outputs:
  docs/a/index.json: |
    { "content": "<p>Link to <a href=\"../a\">1</a> <a href=\"a\">2</a></p>" }
  docs/a/a.json: |
    { "content": "<p>Link to <a href=\"./\">index</a></p>" }
  docs/a.json: |
    { "content": "<p>Link to <a href=\"a/\">index</a></p>" }
---
# HTML encode special charactors in path
inputs:
  docfx.yml:
  docs/a.md: Link to [b](b&/c~.md)
  docs/b&/c~.md:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"b&amp;/c%7E\">b</a></p>" }
  docs/b&/c~.json:
---
# Files redirected to an aboslute URL
inputs:
  docfx.yml: |
    redirections:
      docs/redirect.md: /absolute/path
  docs/a.md: |
    [redirect](redirect.md?a#b)
outputs:
  docs/a.json: |
    {"content":"<p><a href=\"redirect?a#b\">redirect</a></p>"}
---
# Show error if inclusion is a redirection file
inputs:
  docfx.yml: |
    redirections:
      docs/redirect.md: /absolute/path
  docs/a.md: |
    Link to [!INCLUDE[](redirect.md)]
outputs:
  docs/a.json: |
    {"content":"<p>Link to [!include[](redirect.md)]</p>"}
  build.log: |
    ["warning","include-not-found","Cannot resolve 'redirect.md' relative to 'docs/a.md'.","docs/a.md",1,9]
---
# Show warning if redirection file conflicts with existing file
inputs:
  docfx.yml: |
    redirections:
      docs/redirect.md: /absolute/path
  docs/redirect.md:
outputs:
  build.log: |
    ["error","publish-url-conflict","Two or more files publish to the same url '/docs/redirect': 'docs/redirect.md', 'docs/redirect.md <redirection>'"]
---
# Show warning if link to a page outside build scope
inputs:
  docfx.yml: |
    exclude: '*'
  docs/a.md: 'Link to [c](../c.md)'
  docs/b.md: '[!include[](../c.md)]'
  c.md: '[](#self)'
outputs:
  docs/a.json: |
    {"content":"<p>Link to <a href=\"../c\">c</a></p>"}
  docs/b.json: |
    {"content":"<p><a href=\"#self\"></a></p>"}
  build.log: |
    ["warning","link-out-of-scope","File 'c.md' referenced by link '../c.md' will not be built because it is not included in docfx.yml","docs/a.md",1,9]
    ["suggestion","internal-bookmark-not-found","Cannot find bookmark '#self' in 'c.md'","c.md",1,1]
---
# Don't show warning if link to a resource outside build scope
inputs:
  docfx.yml:
  docs/a.md: '[a](../b.png)'
  b.png:
outputs:
  docs/a.json: |
    {"content":"<p><a href=\"../b.png\">a</a></p>"}
  b.png:
---
# Don't show warning if include a page outside build scope
inputs:
  docfx.yml: |
    exclude: '*'
  docs/a.md: '[!include[a](../b.md)]'
  b.md: b
outputs:
  docs/a.json: |
    {"content":"<p>b</p>"}
---
# Show warning if link to a file in dependency repo
inputs:
  docfx.yml: |
    dependencies:
      dep: https://github.com/docascode/docfx-test-dependencies
  docs/a.md: 'Link to [dep](../dep/logo.svg)'
outputs:
  docs/a.json: |
    {"content":"<p>Link to <a href=\"../dep/logo.svg\">dep</a></p>"}
  build.log: |
    ["warning","link-is-dependency","File 'logo.svg' referenced by link '../dep/logo.svg' will not be built because it is from a dependency docset","docs/a.md",1,9]
---
# Don't show warning if include a file from dependency repo
inputs:
  docfx.yml: |
    dependencies:
      dep: https://github.com/docascode/docfx-test-dependencies
  docs/a.md: '[!include[dep](~/dep/dep.md)]'
outputs:
  docs/a.json: |
    {"content":"<p>DEP</p>"}
---
# Link with `~` - default resolveAlias config
inputs:
  docfx.yml:
  docs/a.md: |
    Link to [B1](~/b.md)
    Link to [B2](~/docs/b.md)
    Link to [B3](~docs/b.md)
  docs/b.md:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"%7E/b.md\">B1</a>Link to <a href=\"b\">B2</a>Link to <a href=\"%7Edocs/b.md\">B3</a></p>" }
  docs/b.json:
  build.log: |
    ["warning","file-not-found","Cannot find file '~/b.md' relative to 'docs/a.md'","docs/a.md",1,9]
    ["warning","file-not-found","Cannot find file '~docs/b.md' relative to 'docs/a.md'","docs/a.md",3,9]
---
# Link or Image with resolve alias
inputs:
  docfx.yml: |
    resolveAlias:
      ~: docs
      $ROOT: .
  docs/a.md: |
    Link to [B1](~/b.md)
    Link to [B2]($ROOT/docs/b.md)
    Link to [B3](~/docs/b.md)
    ![C](~/c.png)
  docs/b.md:
  docs/c.png:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"b\">B1</a>\nLink to <a href=\"b\">B2</a>\nLink to <a href=\"%7E/docs/b.md\">B3</a>\n<img src=\"c.png\" alt=\"C\"></p>\n" }
  docs/b.json:
  docs/c.png:
  build.log: |
    ["warning","file-not-found","Cannot find file '~/docs/b.md' relative to 'docs/a.md'","docs/a.md",3,9]
---
# Multiple matched alias, use the last one
inputs:
  docfx.yml: |
    resolveAlias:
      ~: docs
      ~/test: docs
  docs/a.md: |
    Link to [B1](~/b.md)
    Link to [B2](~/test/b.md)
  docs/b.md:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"b\">B1</a>\nLink to <a href=\"b\">B2</a></p>\n" }
  docs/b.json:
---
# If the alias is conflict with the physical path, peek the physical path
inputs:
  docfx.yml: |
    resolveAlias:
      test: docs/test-test
  docs/a.md: |
    Link to [B](test/b.md)
    Link to [C](test/c.md)
  docs/test/b.md:
  docs/test-test/b.md:
  docs/test-test/c.md:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"test/b\">B</a>\nLink to <a href=\"test-test/c\">C</a></p>\n" }
  docs/test/b.json:
  docs/test-test/b.json:
  docs/test-test/c.json:
---
# <a> or <img> tag with resolve alias
inputs:
  docfx.yml: |
    resolveAlias:
      ~: docs
  docs/a.md: |
    Link to <a href="~/b.md">b</a>
    <div>Link to <img src="~/c.png" /></div>
  docs/b.md:
  docs/c.png:
outputs:
  docs/a.json: |
    { "content": "<p>Link to <a href=\"b\">b</a></p>\n<div>Link to <img src=\"c.png\"></div>\n" }
  docs/b.json:
  docs/c.png:
---
# Include with resolve alias
inputs:
  docfx.yml: |
    exclude: '*'
    resolveAlias:
      ~: docs
  docs/a.md: |
    [!include[B1](~/b.md)]
    [!include[B2](~/../b.md)]
  b.md: Token
outputs:
  docs/a.json: |
    { "content": "[!include[B1](~/b.md)]<p>Token</p>\n" }
  build.log: |
    ["warning","include-not-found","Cannot resolve '~/b.md' relative to 'docs/a.md'.","docs/a.md",1,1]
